{"version":3,"file":"minecraft_launcher.js","sources":["src/minecraft_launcher.js"],"sourcesContent":["const jetpack = require('fs-jetpack');\r\nconst jsonfile = require('jsonfile');\r\nconst download = require('download-file');\r\nconst fs = require('fs');\r\nconst path = require('path');\r\nconst unzip = require('unzip');\r\nconst {spawn} = require('child_process');\r\n\r\nconst config = require('./config');\r\nconst minecraft = require('./minecraft');\r\n\r\nlet sessions = {};\r\n\r\nvar operatingSystem = function() {\r\n\tif (process.platform == 'win32')\r\n\t\treturn 'windows';\r\n\telse if (process.platform == 'darwin')\r\n\t\treturn 'osx';\r\n\treturn 'linux';\r\n};\r\n\r\nvar generateSession = function() {\r\n\tvar chars = '0123456789abcdef';\r\n\tvar id = '';\r\n\tvar path;\r\n\tfor (var i = 0; i < 19; i++)\r\n\t\tif (i > 1 && (i+1)%5 == 0)\r\n\t\t\tid += '-';\r\n\t\telse\r\n\t\t\tid += chars[Math.floor(Math.random()*16)];\r\n\r\n\t// Create the path\r\n\tpath = config.tempPath().cwd(id);\r\n\t\r\n\t// Create the temp directory\r\n\tjetpack.dir(path.path());\r\n\r\n\tsessions[id] = {\r\n\t\t'launcherProfile': undefined,\r\n\t\t'profile': undefined,\r\n\t\t'version': undefined,\r\n\t\t'totalLibraries': 0,\r\n\t\t'libraries': [],\r\n\t\t'ready': false,\r\n\t\t'launched': false,\r\n\t\t'javaDir': config.javaPath().path(),\r\n\t\t'tempPath': path.path(),\r\n\t\t'gameDir': config.minecraftPath().path(),\r\n\t\t'jarPath': '',\r\n\t\t'jvmArgs': '',\r\n\t\t'minecraftAccount': minecraft.selectedAccount()\r\n\t};\r\n\treturn id;\r\n};\r\n\r\nexports.preLaunch = function(launcherProfile, callback) {\r\n\r\n\tconsole.log(\"Initiating prelaunch...\");\r\n\r\n\tvar sessionId = generateSession();\r\n\tvar profile = minecraft.profiles()[launcherProfile];\r\n\r\n\t// Save the current profile\r\n\tsessions[sessionId].launcherProfile = launcherProfile;\r\n\tsessions[sessionId].profile = profile;\r\n\r\n\t// Set the game directory\r\n\tif (profile.gameDir != undefined)\r\n\t\tsessions[sessionId].gameDir = profile.gameDir;\r\n\r\n\t// Parse differently if latest release/snapshot\r\n\tif (profile.type == 'latest-release')\r\n\t\treturn latestRelease(profile, callback);\r\n\telse if (profile.type == 'latest-snapshot')\r\n\t\treturn latestSnapshot(profile, callback);\r\n\r\n\t// Check if a java directory is specified\r\n\tif (profile.javaDir != undefined)\r\n\t\tsessions[sessionId].javaDir = profile.javaDir;\r\n\r\n\t// Check if any java args are set\r\n\tif (profile.javaArgs != undefined)\r\n\t\tsessions[sessionId].jvmArgs = profile.javaArgs; \r\n\r\n\t// Get the selected version from the launcher profile\r\n\tvar version = minecraft.installedVersions()[profile.lastVersionId];\r\n\tsessions[sessionId].version = version\r\n\r\n\tvar versionId;\r\n\tif (version.inheritsFrom != undefined) {\r\n\t\t// Really a check needs to be here to download the version if necessare\r\n\t\tversionId = version.inheritsFrom;\r\n\t\tvar libs = minecraft.installedVersions()[versionId].libraries;\r\n\t\tversion.libraries = version.libraries.concat(libs);\r\n\t}\r\n\telse \r\n\t\tversionId = version.id;\r\n\tsessions[sessionId].jarPath = config.minecraftPath().cwd('versions').cwd(versionId).path(versionId + '.jar');\r\n\r\n\t// Parse the libraries\r\n\tprepareLibraries(version.libraries, sessionId);\r\n};\r\n\r\nvar launch = function(sessionId) {\r\n\tconsole.log(\"Launching...\");\r\n\tvar session = sessions[sessionId];\r\n\r\n\tif (session.launched)\r\n\t\treturn;\r\n\tsession.launched = true;\r\n\r\n\r\n\tvar i;\r\n\tvar javaDir = session.javaDir;\r\n\tvar gameDir = session.gameDir;\r\n\tvar assetsRoot = jetpack.cwd(gameDir).path('assets');\r\n\tvar jvmArgs = session.jvmArgs.split(' ');\r\n\tvar username = minecraft.accountUsername(session.minecraftAccount.account);\r\n\tvar libraries = session.libraries.join(';') + ';' + session.jarPath;\r\n\tvar version = session.profile.lastVersionId;\r\n\tvar mcArgs = session.version.minecraftArguments.split(\" \");\r\n\tvar mcArgValues = {\r\n\t\t\"${auth_player_name}\": username,\r\n\t\t\"${version_name}\": version,\r\n\t\t\"${game_directory}\": gameDir,\r\n\t\t\"${assets_root}\": assetsRoot,\r\n\t\t\"${assets_index_name}\": session.version.assets,\r\n\t\t\"${auth_uuid}\": session.minecraftAccount.profile,\r\n\t\t\"${auth_access_token}\": minecraft.accountAccessToken(session.minecraftAccount.account),\r\n\t\t\"${user_type}\": \"mojang\",\r\n\t\t\"${version_type}\": session.version.type\r\n\t};\r\n\r\n\tvar index;\r\n\tvar keys = Object.keys(mcArgValues);\r\n\tfor (i = 0; i < keys.length; i++) {\r\n\t\tindex = mcArgs.indexOf(keys[i]);\r\n\t\tif (index > -1)\r\n\t\t\tmcArgs[index] = mcArgValues[keys[i]];\r\n\t}\r\n\r\n\tvar args = [];\r\n\r\n\tfor (i = 0; i < jvmArgs.length; i++) {\r\n\t\tif (jvmArgs[i].trim().length > 0)\r\n\t\t\targs.push(jvmArgs[i]);\r\n\t}\r\n\r\n\targs.push(\"-Djava.library.path=\" + session.tempPath);\r\n\targs.push(\"-cp\");\r\n\targs.push(libraries);\r\n\targs.push(session.version.mainClass);\r\n\targs = args.concat(mcArgs);\r\n\r\n\tconsole.log(\"The args are\", config.javaPath().path() + ' ' + args.join(\" \"));\r\n\r\n\tvar ls = spawn(config.javaPath().path(), args, {\r\n\t\tdetached: true\r\n\t});\r\n\r\n\tls.stdout.on('data', (data) => {\r\n\t\tconsole.log(`stdout: ${data}`);\r\n\t});\r\n};\r\n\r\nvar latestRelease = function(profile, callback) {\r\n\r\n};\r\n\r\nvar latestSnapshot = function(profile, callback) {\r\n\r\n};\r\n\r\nvar prepareLibraries = function(libraries, sessionId) {\r\n\tfor (var i = 0; i < libraries.length; i++) {\r\n\t\tprepareLibrary(libraries[i], sessionId);\r\n\t}\r\n\r\n\tsessions[sessionId].ready = true;\r\n\tconsole.log(\"Library count:\", sessions[sessionId].totalLibraries, sessions[sessionId].libraries.length)\r\n\tif (sessions[sessionId].totalLibraries == sessions[sessionId].libraries.length)\r\n\t\tlaunch(sessionId);\r\n};\r\n\r\nvar prepareLibrary = function(library, sessionId) {\r\n\r\n\tif (!isLibraryAllowed(library))\r\n\t\treturn;\r\n\r\n\tvar artifact = undefined;\r\n\tif (library.downloads != undefined) {\r\n\t\tif (library.natives == undefined) {\r\n\t\t\tif (library.downloads.artifact != undefined) {\r\n\t\t\t\tartifact = library.downloads.artifact;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tartifact = library.downloads.classifiers[library.natives[operatingSystem()]];\r\n\t\t}\r\n\t} else {\r\n\t\tsessions[sessionId].totalLibraries++;\r\n\t\tparseLocalDependency(library, sessionId);\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Parse the artifact if necessary\r\n\tif (artifact != undefined) {\r\n\t\tsessions[sessionId].totalLibraries++;\r\n\t\tparseArtifact(library, artifact, sessionId);\r\n\t}\r\n};\r\n\r\nvar isLibraryAllowed = function(library) {\r\n\tvar allowed = true;\r\n\tvar rules = library.rules;\r\n\r\n\tif (rules == undefined)\r\n\t\treturn true;\r\n\r\n\tfor (var i = 0; i < rules.length; i++) {\r\n\t\tif (rules[i].action == 'allow')\r\n\t\t\tif (rules[i].os == undefined)\r\n\t\t\t\tallowed = true;\r\n\t\t\telse\r\n\t\t\t\tallowed = rules[i].os.name == operatingSystem();\r\n\t\t\r\n\t\telse if (rules[i].action == 'disallow') {\r\n\t\t\tif (rules[i].os == undefined)\r\n\t\t\t\tallowed = false;\r\n\t\t\telse\r\n\t\t\t\tallowed = rules[i].os.name != operatingSystem();\r\n\t\t}\r\n\t}\r\n\treturn allowed;\r\n};\r\n\r\nvar parseLocalDependency = function(library, sessionId) {\r\n\tvar parts = library.name.split(':');\r\n\tvar path = config.minecraftPath()\r\n\t                 .cwd('libraries')\r\n\t                 .cwd(parts[0].replace(/\\./g, '/'))\r\n\t                 .cwd(parts[1])\r\n\t                 .cwd(parts[2])\r\n\t                 .cwd(parts[1] + '-' + parts[2] + '.jar');\r\n\tconsole.log(\"Parsed local dependency:\", path.path());\r\n\tlibraryFinished(path.path(), sessionId);\r\n};\r\n\r\nvar parseArtifact = function(library, artifact, sessionId) {\r\n\tvar artifactPath = minecraft.minecraftPath().cwd('libraries').cwd(artifact.path);\r\n\tconsole.log(\"Parsing artifact: \", library.name);\r\n\tif (jetpack.exists(artifactPath.path())) {\r\n\t\tif (library.extract != undefined)\r\n\t\t\textractArtifact(library, artifact, artifactPath.path(), sessionId);\r\n\t\telse\r\n\t\t\tlibraryFinished(artifactPath.path(), sessionId);\r\n\t} else {\r\n\t\tdownloadLibrary(library, artifact, artifactPath.path(), sessionId);\r\n\t}\r\n};\r\n\r\nvar downloadLibrary = function(library, artifact, artifactPath, sessionId) {\r\n\tconsole.log(\"Downloading library: \", library.name, artifactPath);\r\n\r\n\t// Download the file\r\n\tvar path = jetpack.cwd(sessions[sessionId].gameDir).path(artifact.path);\r\n\tdownload(\r\n\t\tartifact.url,\r\n\t\t{'directory':  path},\r\n\t\t(error) => {\r\n\t\t\tif (error)\r\n\t\t\t\tconsole.error(\"Failed to download:\", library.name);\r\n\t\t\tif (library.extract == undefined)\r\n\t\t\t\tlibraryFinished(artifactPath, sessionId);\r\n\t\t\telse\r\n\t\t\t\textractArtifact(library, artifact, artifactPath, sessionId);\r\n\t\t});\r\n};\r\n\r\nvar extractArtifact = function(library, artifact, artifactPath, sessionId) {\r\n\tconsole.log(\"Extracting\", library.name);\r\n\r\n\tvar exclude;\r\n\tif (library.extract.exclude == undefined)\r\n\t\texclude = [];\r\n\telse\r\n\t\texclude = library.extract.exclude;\r\n\r\n\tfs.createReadStream(jetpack.cwd(sessions[sessionId].gameDir).cwd('libraries').path(artifact.path))\r\n\t\t.pipe(unzip.Parse())\r\n\t\t.on('entry', (entry) => {\r\n\t\t\tvar fileName = entry.path;\r\n\t\t\tvar type = entry.type; // 'Directory' or 'File' \r\n\t\t\tvar size = entry.size;\r\n\r\n\t\t\tif (exclude.indexOf(fileName) > -1) {\r\n\t\t\t\tconsole.log(\"Excluding\", fileName);\r\n\t\t\t\tentry.autodrain();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (type == 'Directory') {\r\n\t\t\t\tjetpack.dir(jetpack.cwd(sessions[sessionId].tempPath).path(fileName));\r\n\t\t\t\tentry.autodrain();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (jetpack.exists(jetpack.cwd(sessions[sessionId].tempPath).cwd(fileName).path('../')))\r\n\t\t\t\tentry.pipe(fs.createWriteStream(jetpack.cwd(sessions[sessionId].tempPath).path(fileName)));\r\n\t\t\telse\r\n\t\t\t\tentry.autodrain();\r\n\t\t})\r\n\t\t.on('close', () => { libraryFinished(artifactPath, sessionId) });\r\n};\r\n\r\nvar libraryFinished = function(artifactPath, sessionId) {\r\n\tsessions[sessionId].libraries.push(artifactPath);\r\n\tif (sessions[sessionId].totalLibraries == sessions[sessionId].libraries.length &&\r\n\t\tsessions[sessionId].ready)\r\n\t\tlaunch(sessionId);\r\n};"],"names":[],"mappings":"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"}